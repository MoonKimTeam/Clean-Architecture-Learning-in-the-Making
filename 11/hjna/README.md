# 의식적으로 지름길 사용하기

## 깨진 창문 이론

1969년 심리학자 필립 짐바르도의 깨진 창문 이론은 어떤 것의 관리 부재가 더 많은 부정적인 행동을 야기할 수 있음을 설명한다. 번호판 없는 차를 두 환경에 두고 관찰한 결과, 관리되지 않은 환경에서는 차량이 빠르게 손상되었고, 관리된 환경에서는 아무도 차량에 손대지 않았다. 이는 사람들이 환경의 관리 상태를 보고 행동을 조정한다는 점을 보여준다.

### 코드 작업에서의 의미
* 품질이 떨어진 코드에서 작업할 때 더 낮은 품질의 코드를 추가하기 쉽다.
* 코딩 규칙이 많이 어겨진 코드에서 작업할 때 또 다른 규칙을 어기기 쉽다.
* 지름길이 많이 사용된 코드에서 작업할 때 또 다른 지름길을 추가하기 쉽다.

## 깨끗한 상태로 시작할 책임

소프트웨어 프로젝트는 비용이 크고 장기적인 노력이 필요하다. 따라서 깨진 창문을 막는 것은 개발자들의 중요한 책임이다. 잘못된 코드와 관련 없는 레거시를 남기는 것은 프로젝트를 맡을 사람들에게 어려움을 줄 수 있다.

때로는 지름길을 사용하는 것이 유용할 때도 있다. 중요하지 않은 부분이나 프로토타입 단계에서는 경제적인 이유로 지름길을 사용할 수 있다. 이런 경우에는 의도적으로 사용된 지름길임을 문서로 기록해두어야 한다.

마이클 나이가드의 “아키텍처 결정 기록(ADRs)” 형식은 이를 기록하는 데 적합하다. 팀원들이 합리적인 이유로 지름길이 추가되었음을 알고 있다면, 깨진 창문 이론의 영향을 줄일 수 있다.

## 유스케이스 간 모델 공유하기

두 유스케이스에서 사용되는 어떤 입력 모델 클래스가 변경되면 두 유스케이스에 영향을 미친다. 이는 단일 책임 원칙에 따라 “변경하는 이유를 공유하는 것”과 같으며, 출력 모델을 공유하는 경우에도 동일하다.

유스케이스 간 입출력 모델 공유는 유스케이스들이 기능적으로 묶여 있을 때 유효하다. 특정 요구사항을 공유할 때는 적합하지만, 특정 세부사항 변경이 두 유스케이스에 영향을 줄 경우 문제가 된다.

두 유스케이스가 서로 독립적으로 진화해야 한다면 입출력 모델을 공유하지 않아야 한다. 이 경우 동일한 입출력 클래스를 복사해서 분리된 상태에서 시작해야 한다.

비슷한 개념의 유스케이스가 여러 개라면 독립적으로 진화할 필요가 있는지를 주기적으로 점검해야 하며, 대답이 “예”라면 입출력 모델을 분리하는 방향으로 전환해야 한다.

## 도메인 엔티티를 입출력 모델로 사용하기

도메인 엔티티를 입출력 모델로 사용하면 유스케이스와 도메인 엔티티가 결합된다.

도메인 엔티티를 인커밍 포트의 입출력 모델로 사용하는 것은 유스케이스의 변경이 엔티티까지 전파될 위험을 초래한다.

유스케이스가 단순한 데이터베이스 필드 업데이트가 아닌 복잡한 도메인 로직을 포함하면, 전용 입출력 모델을 사용하는 것이 더 적합하다. 이렇게 하면 유스케이스의 변경이 도메인 엔티티에 영향을 미치지 않게 된다.

MVP(최소 기능 제품) 단계에서는 도메인 엔티티를 입출력 모델로 사용할 수 있지만, 점차 복잡도가 증가함에 따라 독립적인 전용 모델로 전환해야 한다.

## 인커밍 포트 건너뛰기

인커밍 포트를 제거하면 인커밍 어댑터와 애플리케이션 계층 사이의 의존성을 줄일 수 있다. 보통 계층을 줄이는 것은 적절한 선택처럼 느껴진다. 하지만, 인커밍 포트는 애플리케이션 중심의 진입점을 정의한다. 이를 제거하면 서비스 호출 방법과 내부 동작 파악에 더 많은 노력이 필요하다. 따라서, 전용 인커밍 포트를 유지하면 코드 이해 및 진입점 식별에 도움이 된다.

인커밍 포트를 유지하는 또 다른 이유는 아키텍처 강제를 쉽게 할 수 있기 때문이다. 이를 통해 애플리케이션 계층과 인커밍 어댑터의 잘못된 연결을 방지할 수 있다. 인커밍 어댑터에서 진입점이 명확히 정의되므로 서비스 메서드 호출 실수를 줄일 수 있다.

## 애플리케이션 서비스 건너뛰기

애플리케이션 서비스 건너뛰기는 어떤 유스케이스에서 애플리케이션 계층을 우회하고 싶은 상황에서 발생한다.

이 방법은 인커밍 어댑터와 아웃고잉 어댑터 사이에 모델을 공유해야 한다. 이는 앞에서 이야기한 도메인 모델 을 입력 모델로 사용하는 케이스가 되는 것이다.

이 방식의 문제는 서비스의 재사용성과 유연성을 떨어뜨릴 수 있다는 점이다. 따라서 단순히 전달만 하는 애플리케이션 서비스는 가능한 피하고, 팀 내에서 명확한 가이드라인을 정해야 한다.
